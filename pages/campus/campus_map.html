<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>校园地图 - Web技术大学</title>
    <link rel="stylesheet" href="../../assets/css/main.css" />
    <!-- 引入字体图标/第三方样式 -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      rel="stylesheet"
    />
    <!-- 引入高德地图API -->
    <script src="https://webapi.amap.com/maps?v=1.4.15&key=您的高德地图API密钥"></script>
    <!-- 引入UI组件库 -->
    <script src="https://webapi.amap.com/ui/1.0/main.js"></script>
  </head>
  <body>
    <!-- 顶部导航栏 -->
    <header class="header">
      <div class="header-top">
        <div class="top-right">
          <a href="../login.html">在校师生</a>
          <a href="../alumni/alumni.html">校友总会</a>
        </div>
      </div>
      <div class="header-main">
        <div class="logo">
          <h1>Web技术大学</h1>
          <p>Web Technology University</p>
        </div>
        <div class="search-box">
          <input
            type="text"
            id="headerSearchInput"
            placeholder="请输入关键词"
          />
          <button onclick="handleSearch()">搜索</button>
        </div>
      </div>
      <nav class="nav">
        <ul>
          <li>
            <a href="../index.html">首页</a>
            <ul class="dropdown">
              <li><a href="../news/news_media.html">校园快讯</a></li>
              <li><a href="../news/news_past.html">通知速递</a></li>
              <li><a href="activities.html">校园活动</a></li>
              <li><a href="../news/news_media.html">今日聚焦</a></li>
            </ul>
          </li>
          <li>
            <a href="../about/intro.html">学校概况</a>
            <ul class="dropdown">
              <li><a href="../about/intro.html">学校简介</a></li>
              <li><a href="../about/leaders.html">领导信息</a></li>
              <li><a href="../about/history.html">办学历史</a></li>
              <li><a href="../about/honors.html">校园荣誉</a></li>
            </ul>
          </li>
          <li>
            <a href="../departments/dept_literature.html">院系设置</a>
            <ul class="dropdown">
              <li><a href="../departments/dept_literature.html">文学院</a></li>
              <li><a href="../departments/dept_science.html">理学院</a></li>
              <li><a href="../departments/dept_engineering.html">工学院</a></li>
              <li><a href="../departments/dept_art.html">艺术学院</a></li>
            </ul>
          </li>
          <li>
            <a href="../news/news_media.html">新闻中心</a>
            <ul class="dropdown">
              <li><a href="../news/news_media.html">媒体报道</a></li>
              <li><a href="../news/news_photos.html">图片新闻</a></li>
              <li><a href="../news/news_videos.html">视频集锦</a></li>
              <li><a href="../news/news_past.html">往期新闻</a></li>
            </ul>
          </li>
          <li>
            <a href="../admissions/admission_guide.html">招生就业</a>
            <ul class="dropdown">
              <li><a href="../admissions/admission_guide.html">招生简章</a></li>
              <li><a href="../admissions/employment.html">就业信息</a></li>
              <li><a href="../admissions/graduates.html">毕业生风采</a></li>
              <li><a href="../admissions/apply_guide.html">报考指南</a></li>
            </ul>
          </li>
          <li>
            <a href="../research/research_projects.html">科学研究</a>
            <ul class="dropdown">
              <li><a href="../research/research_projects.html">科研项目</a></li>
              <li><a href="../research/achievements.html">成果展示</a></li>
              <li><a href="../research/teams.html">研究团队</a></li>
              <li><a href="../research/journals.html">学术期刊</a></li>
            </ul>
          </li>
          <li>
            <a href="clubs.html">校园文化</a>
            <ul class="dropdown">
              <li><a href="clubs.html">学生社团</a></li>
              <li><a href="activities.html">文化活动</a></li>
              <li><a href="art_show.html">艺术展演</a></li>
              <li><a href="campus_map.html">校园地图</a></li>
              <li><a href="../contact.html">联系我们</a></li>
            </ul>
          </li>
        </ul>
      </nav>
    </header>

    <div class="breadcrumb">
      当前位置：<a href="../index.html">首页</a> > <a href="clubs.html">校园文化</a> > 校园地图
    </div>

    <!-- 页面内容 -->
    <main class="page-container">
      <!-- 左侧导航 -->
      <aside class="sidebar">
        <h3 class="sidebar-title">校园地图</h3>
        <ul class="sidebar-menu">
          <li><a href="#" class="active" data-building="library">图书馆</a></li>
          <li><a href="#" data-building="teaching">教学楼</a></li>
          <li><a href="#" data-building="dormitory">学生宿舍</a></li>
          <li><a href="#" data-building="canteen">食堂</a></li>
          <li><a href="#" data-building="gym">体育馆</a></li>
          <li><a href="#" data-building="laboratory">实验楼</a></li>
          <li><a href="#" data-building="admin">行政楼</a></li>
          <li><a href="#" data-building="playground">运动场</a></li>
        </ul>
      </aside>

      <!-- 右侧内容 -->
      <div class="page-content">
        <h2 class="page-title">校园地图</h2>
        <p>欢迎使用Web技术大学校园地图，您可以通过左侧菜单或搜索框查找校园内的各个建筑和设施。</p>
        
        <!-- 地图搜索框 -->
        <div class="map-search-container">
          <input type="text" id="mapSearchInput" placeholder="搜索校园建筑或设施" />
          <button id="mapSearchBtn">搜索</button>
        </div>
        
        <!-- 地图容器 -->
        <div id="campusMap" class="campus-map-container"></div>
        
        <!-- 地图控件 -->
        <div class="map-controls">
          <button id="resetMapBtn" class="btn btn-primary">重置地图</button>
          <button id="satelliteMapBtn" class="btn btn-outline">卫星地图</button>
          <button id="trafficMapBtn" class="btn btn-outline">交通状况</button>
        </div>
      </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
      <div class="footer-top">
        <h3>Web技术大学</h3>
        <p>地址：XX省XX市高新区文理大道1号</p>
      </div>
      <div class="footer-bottom">
        <div class="links">
          <span>相关链接：</span>
          <a href="http://www.moe.gov.cn/" target="_blank"
            >中华人民共和国教育部</a
          >
          <a href="https://www.edu.cn/" target="_blank">中国教育科研网</a>
        </div>
        <div class="nav-links">
          <a href="../index.html">快速导航</a>
          <a href="../about/intro.html">学校概况</a>
          <a href="../departments/dept_literature.html">院系设置</a>
          <a href="../contact.html">联系我们</a>
        </div>
      </div>
    </footer>

    <!-- 回到顶部按钮 -->
    <button id="backToTop" title="回到顶部">
      <i class="fas fa-arrow-up"></i>
    </button>

    <script src="../../assets/js/main.js"></script>
    <script>
      // 校园地图初始化
      document.addEventListener('DOMContentLoaded', function() {
        initCampusMap();
      });
      
      // 初始化校园地图
      function initCampusMap() {
        // 初始化地图
        const map = new AMap.Map('campusMap', {
          resizeEnable: true,
          center: [116.397428, 39.90923], // 学校中心坐标
          zoom: 16
        });
        
        // 添加地图控件
        map.addControl(new AMap.ToolBar());
        map.addControl(new AMap.Scale());
        map.addControl(new AMap.MapType());
        
        // 校园建筑数据
        const campusBuildings = {
          library: {
            name: '图书馆',
            position: [116.397428, 39.90923],
            description: '学校图书馆，提供丰富的图书资源和学习空间',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-1.png'
          },
          teaching: {
            name: '教学楼',
            position: [116.395428, 39.90823],
            description: '主要教学楼，包含多个教室和实验室',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-2.png'
          },
          dormitory: {
            name: '学生宿舍',
            position: [116.398428, 39.90723],
            description: '学生宿舍区，提供舒适的住宿环境',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-3.png'
          },
          canteen: {
            name: '食堂',
            position: [116.396428, 39.90723],
            description: '学校食堂，提供各种美食',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-4.png'
          },
          gym: {
            name: '体育馆',
            position: [116.399428, 39.90923],
            description: '体育馆，包含篮球馆、游泳馆等设施',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-5.png'
          },
          laboratory: {
            name: '实验楼',
            position: [116.395428, 39.91023],
            description: '实验楼，用于各种科学实验',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-6.png'
          },
          admin: {
            name: '行政楼',
            position: [116.398428, 39.91023],
            description: '学校行政楼，包含各部门办公室',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-7.png'
          },
          playground: {
            name: '运动场',
            position: [116.400428, 39.90823],
            description: '室外运动场，包含足球场、田径场等',
            icon: 'https://webapi.amap.com/theme/v1.3/icons/poi-8.png'
          }
        };
        
        // 在地图上添加标记
        for (const key in campusBuildings) {
          const building = campusBuildings[key];
          const marker = new AMap.Marker({
            position: building.position,
            title: building.name,
            icon: new AMap.Icon({
              size: new AMap.Size(32, 32),
              image: building.icon,
              imageSize: new AMap.Size(32, 32)
            }),
            extData: { id: key, ...building }
          });
          
          // 添加信息窗口
          const infoWindow = new AMap.InfoWindow({
            content: `<h3>${building.name}</h3><p>${building.description}</p>`,
            offset: new AMap.Pixel(0, -30)
          });
          
          // 点击标记显示信息窗口
          marker.on('click', function() {
            infoWindow.open(map, this.getPosition());
          });
          
          // 将标记添加到地图
          map.add(marker);
        }
        
        // 左侧菜单点击事件
        const menuItems = document.querySelectorAll('.sidebar-menu li a');
        menuItems.forEach(item => {
          item.addEventListener('click', function(e) {
            e.preventDefault();
            
            // 移除所有活动状态
            menuItems.forEach(menu => menu.classList.remove('active'));
            // 添加当前活动状态
            this.classList.add('active');
            
            // 获取点击的建筑
            const buildingId = this.getAttribute('data-building');
            const building = campusBuildings[buildingId];
            
            if (building) {
              // 移动地图到该建筑
              map.setCenter(building.position);
              map.setZoom(18);
            }
          });
        });
        
        // 地图搜索功能
        const searchInput = document.getElementById('mapSearchInput');
        const searchBtn = document.getElementById('mapSearchBtn');
        
        searchBtn.addEventListener('click', function() {
          const keyword = searchInput.value.trim();
          if (keyword) {
            // 简单的本地搜索
            for (const key in campusBuildings) {
              const building = campusBuildings[key];
              if (building.name.includes(keyword) || building.description.includes(keyword)) {
                map.setCenter(building.position);
                map.setZoom(18);
                break;
              }
            }
          }
        });
        
        // 搜索框回车事件
        searchInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            searchBtn.click();
          }
        });
        
        // 重置地图按钮
        const resetMapBtn = document.getElementById('resetMapBtn');
        resetMapBtn.addEventListener('click', function() {
          map.setCenter([116.397428, 39.90923]);
          map.setZoom(16);
        });
        
        // 卫星地图切换
        const satelliteMapBtn = document.getElementById('satelliteMapBtn');
        let isSatellite = false;
        satelliteMapBtn.addEventListener('click', function() {
          isSatellite = !isSatellite;
          if (isSatellite) {
            map.setMapStyle('satellite');
            this.textContent = '普通地图';
          } else {
            map.setMapStyle('normal');
            this.textContent = '卫星地图';
          }
        });
        
        // 交通状况切换
        const trafficMapBtn = document.getElementById('trafficMapBtn');
        let isTraffic = false;
        trafficMapBtn.addEventListener('click', function() {
          isTraffic = !isTraffic;
          if (isTraffic) {
            map.plugin('AMap.Traffic', function() {
              const traffic = new AMap.Traffic();
              map.add(traffic);
            });
            this.textContent = '关闭交通';
          } else {
            map.remove(map.getLayers().filter(layer => layer instanceof AMap.Traffic));
            this.textContent = '交通状况';
          }
        });
      }
    </script>
  </body>
</html>